# Individual Project Machine Learning Software (IPMLS)

## Description

The Individual Project Machine Learning Software (IPMLS) is a Python-based project aimed at automating the process of generating labelled data from satellite imagery and utilizing this data for machine learning tasks.  It consists of two main components:

* **Individual Project Data Generation Software (IPDGS):** This component focuses on processing satellite imagery (specifically Sentinel-2) to calculate water indices and facilitate the manual labelling of regions of interest.  IPDGS generates the training data required for the IPRFM.
* **Individual Project Random Forest Model (IPRFM):** (This component is planned but not yet implemented) This component will utilize the labelled data generated by IPDGS to train a Random Forest model for water body identification or related tasks.

This README primarily describes the IPDGS component.

## Individual Project Data Generation Software (IPDGS)

IPDGS is designed to:

* Calculate key water indices: NDWI, MNDWI, AWEI-SH, and AWEI-NSH.
* Perform cloud masking to improve the accuracy of water index calculations.
* Enable users to visually inspect and label regions of interest (ROIs) within satellite images.
* Process Sentinel-2 imagery at different resolutions.

### Features

* **Modular Design:** Well-organized modules for satellite band selection, index calculations, image manipulation, and utilities.
* **Water Index Calculation:** Efficient calculation of essential water indices using NumPy.
* **Cloud Masking:** Automated cloud masking to ensure accurate water analysis.
* **Interactive Labelling:** A graphical user interface (Tkinter) for easy region of interest (ROI) selection and labelling.
* **Sentinel-2 Support:** Specifically designed to process Sentinel-2 imagery with handling for different band resolutions.
* **Flexible Processing:** Options for high/low resolution processing and saving/displaying images.
* **Error Handling:** Robust error handling to manage file operations and user inputs.

### Installation

1.  **Clone the repository:**

    ```bash
    git clone https://github.com/nicoarrroyo/IPMLS/tree/main
    cd IPMLS
    ```

2.  **Install the required dependencies:**

    ```bash
    pip install numpy matplotlib Pillow tkinter
    ```

    * Ensure you have Python 3.11.11 installed.

### Usage

1.  **Prepare your Sentinel-2 data:**
    * Download Sentinel-2 imagery and organize it into the required directory structure. The code expects a specific folder structure within the main directory (see `IPDGS.py` for details on the expected file paths).
2.  **Configure settings (Optional):**
    * Modify the variables at the beginning of `IPDGS.py` to adjust processing parameters such as:
        * `high_res`: Process at 10m resolution (True) or 60m resolution (False).
        * `save_images`: Save output images (True) or not (False).
        * `show_index_plots`: Display water index plots (True) or not (False).
        * `label_data`: Enable the data labelling tool (True) or not (False).
        * `n_chunks`: Number of chunks to split the image into for labelling.
        * NOT OPTIONAL - `HOME`: The main directory where the Sentinel-2 data is located. You will need to modify this variable to point to the correct path on your system.
3.  **Run the `IPDGS.py` script:**

    ```bash
    python IPDGS.py
    ```

4.  **Data Labelling (if enabled):**

    * If `label_data` is set to `True`, the script will guide you through the process of labelling regions of interest (reservoirs and other water bodies) in the imagery.
    * Follow the on-screen prompts to draw rectangles around the features.
    * The labelling results are saved to a CSV file (`responses_<n_chunks>_chunks.csv`), which will be used to train the IPRFM.

### Code Structure

* `IPDGS.py`: The main script that orchestrates the image processing and labelling workflow for data generation.
* `calculation_functions.py`: Contains functions for calculating water indices (NDWI, MNDWI, AWEI).
* `image_functions.py`: Provides functions for image manipulation (opening, masking, plotting, ROI selection).
* `misc_functions.py`: Includes miscellaneous utility functions (printing tables, array splitting, file handling, spinner).
* `satellite_functions.py`: Handles satellite band selection for Sentinel-2.

### Individual Project Random Forest Model (IPRFM)

* (Planned) This module will contain the code for training and utilizing a Random Forest model. It will take the labelled data generated by IPDGS as input.  Further details will be added as this component is developed.

### Contributing

1.  **Fork the repository.**
2.  **Create a new branch for your feature or bug fix.**
3.  **Make your changes and commit them.**
4.  **Push your changes to your fork.**
5.  **Submit a pull request.**

### License

[-]

### Acknowledgements

* [-]

### Contact

* Nicolas Arroyo, nicolas.renato.arroyo@gmail.com, he/him
